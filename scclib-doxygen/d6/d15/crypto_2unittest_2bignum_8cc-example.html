<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scclib: crypto/unittest/bignum.cc</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">scclib
   </div>
   <div id="projectbrief">Stable Cloud Computing C++ Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">crypto/unittest/bignum.cc</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">BSD 3-Clause License</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Copyright (c) 2022, Stable Cloud Computing, Inc.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment">modification, are permitted provided that the following conditions are met:</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">1. Redistributions of source code must retain the above copyright notice, this</span></div>
<div class="line"><span class="comment">   list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">2. Redistributions in binary form must reproduce the above copyright notice,</span></div>
<div class="line"><span class="comment">   this list of conditions and the following disclaimer in the documentation</span></div>
<div class="line"><span class="comment">   and/or other materials provided with the distribution.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">3. Neither the name of the copyright holder nor the names of its</span></div>
<div class="line"><span class="comment">   contributors may be used to endorse or promote products derived from</span></div>
<div class="line"><span class="comment">   this software without specific prior written permission.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span></div>
<div class="line"><span class="comment">AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span></div>
<div class="line"><span class="comment">IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span></div>
<div class="line"><span class="comment">DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span></div>
<div class="line"><span class="comment">FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span></div>
<div class="line"><span class="comment">DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span></div>
<div class="line"><span class="comment">SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span></div>
<div class="line"><span class="comment">CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span></div>
<div class="line"><span class="comment">OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment">OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../dd/da2/bignum_8h.html">crypto/bignum.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;gtest/gtest.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d0/d84/hex_8h.html">encode/hex.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> std::cout;</div>
<div class="line"><span class="keyword">using</span> std::endl;</div>
<div class="line"><span class="keyword">using</span> std::vector;</div>
<div class="line"><span class="keyword">using</span> std::runtime_error;</div>
<div class="line"><span class="keyword">using</span> <a name="_a0"></a><a class="code" href="../../d2/ddc/classscc_1_1encode_1_1Hex.html">scc::encode::Hex</a>;</div>
<div class="line"><span class="keyword">using</span> <a name="_a1"></a><a class="code" href="../../da/d2a/classscc_1_1crypto_1_1Bignum.html">scc::crypto::Bignum</a>;</div>
<div class="line"> </div>
<div class="line"><a name="a2"></a><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, init)</div>
<div class="line">{</div>
<div class="line">    Bignum n;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Init: &quot;</span> &lt;&lt; n &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(n.str(), <span class="stringliteral">&quot;0&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, set_zero)</div>
<div class="line">{</div>
<div class="line">    Bignum n;</div>
<div class="line">    n = 0;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Zero: &quot;</span> &lt;&lt; n &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(n.str(), <span class="stringliteral">&quot;0&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, set_one)</div>
<div class="line">{</div>
<div class="line">    Bignum n;</div>
<div class="line">    n = 1;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;One: &quot;</span> &lt;&lt; n &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(n.str(), <span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, init_ten)</div>
<div class="line">{</div>
<div class="line">    Bignum n(10);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Init ten: &quot;</span> &lt;&lt; n &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(n.str(), <span class="stringliteral">&quot;10&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, copy_construct)</div>
<div class="line">{</div>
<div class="line">    Bignum a(10);</div>
<div class="line">    Bignum b(a);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;copy_construct a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; b=&quot;</span> &lt;&lt; b &lt;&lt; endl;</div>
<div class="line">    ASSERT_TRUE(a == 10);</div>
<div class="line">    ASSERT_TRUE(b == 10);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, copy_op)</div>
<div class="line">{</div>
<div class="line">    Bignum a(10);</div>
<div class="line">    Bignum b;</div>
<div class="line">    b = a;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;copy_op a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; b=&quot;</span> &lt;&lt; b &lt;&lt; endl;</div>
<div class="line">    ASSERT_TRUE(a == 10);</div>
<div class="line">    ASSERT_TRUE(b == 10);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, move_construct)</div>
<div class="line">{</div>
<div class="line">    Bignum a(10);</div>
<div class="line">    Bignum b = std::move(a);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;move_construct a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; b=&quot;</span> &lt;&lt; b &lt;&lt; endl;</div>
<div class="line">    ASSERT_TRUE(b == 10);</div>
<div class="line">    ASSERT_FALSE(a == 10);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, move_opt)</div>
<div class="line">{</div>
<div class="line">    Bignum a(10);</div>
<div class="line">    Bignum b;</div>
<div class="line">    b = std::move(a);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;move_op a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; b=&quot;</span> &lt;&lt; b &lt;&lt; endl;</div>
<div class="line">    ASSERT_TRUE(b == 10);</div>
<div class="line">    ASSERT_FALSE(a == 10);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, print_hex)</div>
<div class="line">{</div>
<div class="line">    Bignum a(1 &lt;&lt; 20);</div>
<div class="line">    a += 15*16;</div>
<div class="line">    a = -a;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;print_hex &quot;</span> &lt;&lt; std::hex &lt;&lt; a &lt;&lt; std::dec &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(a.str(<span class="keyword">true</span>), <span class="stringliteral">&quot;-1000f0&quot;</span>);</div>
<div class="line">    </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, print_dec)</div>
<div class="line">{</div>
<div class="line">    Bignum a(1 &lt;&lt; 20);</div>
<div class="line">    a = -a;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;print_dec &quot;</span> &lt;&lt; a &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(a.str(), <span class="stringliteral">&quot;-1048576&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, compare)</div>
<div class="line">{</div>
<div class="line">    Bignum one(1), ten(10);</div>
<div class="line">    ASSERT_TRUE(one == one);</div>
<div class="line">    ASSERT_TRUE(one &gt;= one);</div>
<div class="line">    ASSERT_TRUE(one &lt;= one);</div>
<div class="line">    ASSERT_FALSE(one &lt; one);</div>
<div class="line">    ASSERT_FALSE(one &gt; one);</div>
<div class="line">    ASSERT_TRUE(one != ten);</div>
<div class="line">    ASSERT_TRUE(one &lt; ten);</div>
<div class="line">    ASSERT_TRUE(one &lt;= ten);</div>
<div class="line">    ASSERT_TRUE(ten &gt; one);</div>
<div class="line">    ASSERT_TRUE(ten &gt;= one);</div>
<div class="line">    ASSERT_TRUE(one == 1);</div>
<div class="line">    ASSERT_TRUE(one &gt;= 1);</div>
<div class="line">    ASSERT_TRUE(one &lt;= 1);</div>
<div class="line">    ASSERT_FALSE(one &lt; 1);</div>
<div class="line">    ASSERT_FALSE(one &gt; 1);</div>
<div class="line">    ASSERT_TRUE(one != 10);</div>
<div class="line">    ASSERT_TRUE(one &lt; 10);</div>
<div class="line">    ASSERT_TRUE(one &lt;= 10);</div>
<div class="line">    ASSERT_TRUE(ten &gt; 1);</div>
<div class="line">    ASSERT_TRUE(ten &gt;= 1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, shift)</div>
<div class="line">{</div>
<div class="line">    Bignum one(1);</div>
<div class="line">    Bignum sft(1&lt;&lt;7);</div>
<div class="line">    Bignum a(1);</div>
<div class="line"> </div>
<div class="line">    a &lt;&lt;= 7;</div>
<div class="line">    ASSERT_EQ(a, sft);</div>
<div class="line">    Bignum b = one &lt;&lt; 7;</div>
<div class="line">    ASSERT_EQ(b, sft);</div>
<div class="line">    Bignum c(sft);</div>
<div class="line">    c &gt;&gt;= 7;</div>
<div class="line">    ASSERT_EQ(c, one);</div>
<div class="line">    Bignum d = sft &gt;&gt; 7;</div>
<div class="line">    ASSERT_EQ(d, one);</div>
<div class="line">    Bignum shiftaway(123456);</div>
<div class="line">    shiftaway &gt;&gt;= shiftaway.width();</div>
<div class="line">    ASSERT_EQ(shiftaway, 0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, big_shift)</div>
<div class="line">{</div>
<div class="line">    Bignum n(0xffff0000);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;bigshift in  : &quot;</span> &lt;&lt; std::hex &lt;&lt; n &lt;&lt; std::dec &lt;&lt; <span class="stringliteral">&quot; width: &quot;</span> &lt;&lt; n.width() &lt;&lt; endl;</div>
<div class="line">    n &lt;&lt;= 47;</div>
<div class="line">    <span class="keyword">auto</span> hx = n.str(<span class="keyword">true</span>);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;bigshift &lt;&lt;47: &quot;</span> &lt;&lt; std::hex &lt;&lt; hx &lt;&lt; std::dec &lt;&lt; <span class="stringliteral">&quot; width: &quot;</span> &lt;&lt; n.width() &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(n.width(), 32+47);</div>
<div class="line">    ASSERT_EQ(hx, <span class="stringliteral">&quot;7fff8000000000000000&quot;</span>);</div>
<div class="line">    n &gt;&gt;= 9;</div>
<div class="line">    hx = n.str(<span class="keyword">true</span>);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;bigshift &gt;&gt;9: &quot;</span> &lt;&lt; std::hex &lt;&lt; hx &lt;&lt; std::dec &lt;&lt; <span class="stringliteral">&quot; width: &quot;</span> &lt;&lt; n.width() &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(hx, <span class="stringliteral">&quot;3fffc0000000000000&quot;</span>);</div>
<div class="line">    ASSERT_EQ(n.width(), 32+47-9);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, incdec)</div>
<div class="line">{</div>
<div class="line">    Bignum a;</div>
<div class="line">    a = 1;</div>
<div class="line">    ASSERT_EQ(++a, 2);</div>
<div class="line">    ASSERT_EQ(a, 2);</div>
<div class="line">    ASSERT_EQ(a++, 2);</div>
<div class="line">    ASSERT_EQ(a, 3);</div>
<div class="line">    ASSERT_EQ(--a, 2);</div>
<div class="line">    ASSERT_EQ(a, 2);</div>
<div class="line">    ASSERT_EQ(a--, 2);</div>
<div class="line">    ASSERT_EQ(a, 1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, arith)</div>
<div class="line">{</div>
<div class="line">    Bignum zero, one(1), two(2), three(3), nine(9), ten(10), eleven(11), twelve(12), hund(100);</div>
<div class="line"> </div>
<div class="line">    Bignum a = one * ten;</div>
<div class="line">    ASSERT_EQ(a, ten);</div>
<div class="line">    a /= ten;</div>
<div class="line">    ASSERT_EQ(a, one);</div>
<div class="line"> </div>
<div class="line">    a = nine / three;</div>
<div class="line">    ASSERT_EQ(a, three);</div>
<div class="line">    a *= three;</div>
<div class="line">    ASSERT_EQ(a, nine);</div>
<div class="line"> </div>
<div class="line">    a = nine + one;</div>
<div class="line">    ASSERT_EQ(a, ten);</div>
<div class="line">    a -= one;</div>
<div class="line">    ASSERT_EQ(a, nine);</div>
<div class="line"> </div>
<div class="line">    a = ten - one;</div>
<div class="line">    ASSERT_EQ(a, nine);</div>
<div class="line">    a += one;</div>
<div class="line">    ASSERT_EQ(a, ten);</div>
<div class="line"> </div>
<div class="line">    a = hund % nine;</div>
<div class="line">    ASSERT_EQ(a, one);</div>
<div class="line"> </div>
<div class="line">    a = hund;</div>
<div class="line">    Bignum rem;</div>
<div class="line">    a.div(nine, &amp;rem);</div>
<div class="line">    ASSERT_EQ(a, eleven);</div>
<div class="line">    ASSERT_EQ(rem, one);</div>
<div class="line"> </div>
<div class="line">    a = <a name="a3"></a><a class="code" href="../../dd/da2/bignum_8h.html#a404ea288a7ccbcdcf2de54410ce68847">exp</a>(nine, zero);</div>
<div class="line">    ASSERT_EQ(a, one);</div>
<div class="line"> </div>
<div class="line">    a = <a class="code" href="../../dd/da2/bignum_8h.html#a404ea288a7ccbcdcf2de54410ce68847">exp</a>(ten, two);</div>
<div class="line">    ASSERT_EQ(a, hund);</div>
<div class="line">    a = ten;</div>
<div class="line">    a.exp(two);</div>
<div class="line">    ASSERT_EQ(a, hund);</div>
<div class="line"> </div>
<div class="line">    a = <a name="a4"></a><a class="code" href="../../dd/da2/bignum_8h.html#abc9625a3e7b87afe6a826394a00f19b3">gcd</a>(nine, twelve);</div>
<div class="line">    ASSERT_EQ(a, three);</div>
<div class="line">    a = nine;</div>
<div class="line">    a.gcd(twelve);</div>
<div class="line">    ASSERT_EQ(a, three);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, arith_num)</div>
<div class="line">{</div>
<div class="line">    Bignum one(1), two(2), three(3), nine(9), ten(10), eleven(11), twelve(12), hund(100);</div>
<div class="line"> </div>
<div class="line">    Bignum a = one * 10;</div>
<div class="line">    ASSERT_EQ(a, 10);</div>
<div class="line">    a /= 10;</div>
<div class="line">    ASSERT_EQ(a, 1);</div>
<div class="line"> </div>
<div class="line">    a = nine / 3;</div>
<div class="line">    ASSERT_EQ(a, 3);</div>
<div class="line">    a *= 3;</div>
<div class="line">    ASSERT_EQ(a, 9);</div>
<div class="line"> </div>
<div class="line">    a = nine + 1;</div>
<div class="line">    ASSERT_EQ(a, 10);</div>
<div class="line">    a -= 1;</div>
<div class="line">    ASSERT_EQ(a, 9);</div>
<div class="line"> </div>
<div class="line">    a = ten - 1;</div>
<div class="line">    ASSERT_EQ(a, 9);</div>
<div class="line">    a += 1;</div>
<div class="line">    ASSERT_EQ(a, 10);</div>
<div class="line"> </div>
<div class="line">    a = hund % 9;</div>
<div class="line">    ASSERT_EQ(a, 1);</div>
<div class="line"> </div>
<div class="line">    a = hund;</div>
<div class="line">    Bignum rem;</div>
<div class="line">    a.div(nine, &amp;rem);</div>
<div class="line">    ASSERT_EQ(a, 11);</div>
<div class="line">    ASSERT_EQ(rem, 1);</div>
<div class="line"> </div>
<div class="line">    a = <a class="code" href="../../dd/da2/bignum_8h.html#a404ea288a7ccbcdcf2de54410ce68847">exp</a>(nine, 0);</div>
<div class="line">    ASSERT_EQ(a, 1);</div>
<div class="line"> </div>
<div class="line">    a = <a class="code" href="../../dd/da2/bignum_8h.html#a404ea288a7ccbcdcf2de54410ce68847">exp</a>(ten, 2);</div>
<div class="line">    ASSERT_EQ(a, 100);</div>
<div class="line">    a = ten;</div>
<div class="line">    a.exp(2);</div>
<div class="line">    ASSERT_EQ(a, 100);</div>
<div class="line"> </div>
<div class="line">    a = <a class="code" href="../../dd/da2/bignum_8h.html#abc9625a3e7b87afe6a826394a00f19b3">gcd</a>(nine, 12);</div>
<div class="line">    ASSERT_EQ(a, 3);</div>
<div class="line">    a = nine;</div>
<div class="line">    a.gcd(12);</div>
<div class="line">    ASSERT_EQ(a, 3);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, prime)</div>
<div class="line">{</div>
<div class="line">    Bignum p1(217645177);</div>
<div class="line">    Bignum p2(236887691);</div>
<div class="line">    ASSERT_TRUE(p1.is_prime());</div>
<div class="line">    ASSERT_TRUE(p2.is_prime());</div>
<div class="line">    Bignum c = p1*p2;</div>
<div class="line">    ASSERT_FALSE(c.is_prime());</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Prime 1:   &quot;</span> &lt;&lt; p1 &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Prime 2:   &quot;</span> &lt;&lt; p2 &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Composite: &quot;</span> &lt;&lt; c &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// find the first hundred primes (see primes.utm.edu)</span></div>
<div class="line">    <span class="keywordtype">int</span> count = 0;</div>
<div class="line">    Bignum b;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 2; t &lt;= 541; t++)</div>
<div class="line">    {</div>
<div class="line">        b = t;</div>
<div class="line">        <span class="keywordflow">if</span> (b.is_prime())</div>
<div class="line">            count++;</div>
<div class="line">    }</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;First hundred primes found: &quot;</span> &lt;&lt; count &lt;&lt; endl;</div>
<div class="line">    EXPECT_EQ(count, 100);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, <a class="code" href="../../dd/da2/bignum_8h.html#abc9625a3e7b87afe6a826394a00f19b3">gcd</a>)</div>
<div class="line">{</div>
<div class="line">    Bignum p1(2829604451);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;p1: &quot;</span> &lt;&lt; std::hex &lt;&lt; p1 &lt;&lt; endl;</div>
<div class="line">    ASSERT_TRUE(p1.is_prime());</div>
<div class="line">    Bignum p2(1787494861);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;p2: &quot;</span> &lt;&lt; std::hex &lt;&lt; p2 &lt;&lt; endl;</div>
<div class="line">    ASSERT_TRUE(p2.is_prime());</div>
<div class="line">    Bignum p3(3954380029);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;p3: &quot;</span> &lt;&lt; std::hex &lt;&lt; p3 &lt;&lt; endl;</div>
<div class="line">    ASSERT_TRUE(p3.is_prime());</div>
<div class="line">    Bignum p12 = p1 * p2;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;p1 * p2: &quot;</span> &lt;&lt; std::hex &lt;&lt; p12 &lt;&lt; endl;</div>
<div class="line">    Bignum p13 = p1 * p3;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;p1 * p3: &quot;</span> &lt;&lt; std::hex &lt;&lt; p13 &lt;&lt; endl;</div>
<div class="line">    Bignum <a class="code" href="../../dd/da2/bignum_8h.html#abc9625a3e7b87afe6a826394a00f19b3">gcd</a>(p12);</div>
<div class="line">    <a class="code" href="../../dd/da2/bignum_8h.html#abc9625a3e7b87afe6a826394a00f19b3">gcd</a>.<a name="a5"></a><a class="code" href="../../da/d2a/classscc_1_1crypto_1_1Bignum.html#a5d000d47bfb2c00443acc33535d6aaf4">gcd</a>(p13);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;gcd: &quot;</span> &lt;&lt; std::hex &lt;&lt; <a class="code" href="../../dd/da2/bignum_8h.html#abc9625a3e7b87afe6a826394a00f19b3">gcd</a> &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(p1, <a class="code" href="../../dd/da2/bignum_8h.html#abc9625a3e7b87afe6a826394a00f19b3">gcd</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, bintest)</div>
<div class="line">{</div>
<div class="line">    uint8_t octval[] = <span class="stringliteral">&quot;\x12\x34\x56\x78\x9a\xbc\xde\xf0&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\xcc&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    Bignum b(octval, <span class="keyword">sizeof</span>(octval));</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;bin: &quot;</span> &lt;&lt; std::hex &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::dec &lt;&lt; b &lt;&lt; endl;</div>
<div class="line">    Bignum t;</div>
<div class="line">    t = 0x12345678;</div>
<div class="line">    t &lt;&lt;= 32;</div>
<div class="line">    t += 0x9abcdef0;</div>
<div class="line">    t &lt;&lt;= 16;</div>
<div class="line">    t += 0xcc00;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;tst: &quot;</span> &lt;&lt; std::hex &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::dec &lt;&lt; t &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(b, t);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, generate_rand)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> gen = [](<span class="keywordtype">int</span> w, <span class="keywordtype">bool</span> s=<span class="keyword">false</span>, <span class="keywordtype">bool</span> o=<span class="keyword">false</span>)</div>
<div class="line">    {</div>
<div class="line">        Bignum p;</div>
<div class="line">        p.gen_rand(w, s, o);</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;genrand request width=&quot;</span>&lt;&lt;w&lt;&lt;<span class="stringliteral">&quot; strong=&quot;</span>&lt;&lt;s&lt;&lt;<span class="stringliteral">&quot; odd=&quot;</span>&lt;&lt;o&lt;&lt;<span class="stringliteral">&quot;: &quot;</span> &lt;&lt; std::hex &lt;&lt; p &lt;&lt; std::dec &lt;&lt; <span class="stringliteral">&quot; width: &quot;</span> &lt;&lt; p.width() &lt;&lt; endl;</div>
<div class="line">        ASSERT_LE(p.width(), w);</div>
<div class="line">        <span class="keywordflow">if</span> (s)</div>
<div class="line">        {</div>
<div class="line">            ASSERT_TRUE(p.is_bit_set(w-1));</div>
<div class="line">            ASSERT_TRUE(p.is_bit_set(w-2));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (o)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// must be odd</span></div>
<div class="line">            ASSERT_TRUE(p.is_bit_set(0));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">    };</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= 128; i++)      gen(i);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= 128; i++)      gen(i, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt;= 128; i++)      gen(i, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt;= 128; i++)      gen(i, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// https://prime-numbers.info/list/first-1000-primes</span></div>
<div class="line"><span class="comment">// https://prime-numbers.info/list/safe-primes (this library does not generate them, but will check here)</span></div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, generate_primes)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> gen = [](<span class="keywordtype">int</span> w)</div>
<div class="line">    {</div>
<div class="line">        Bignum p;</div>
<div class="line">        p.gen_prime(w);</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;genprime width=&quot;</span> &lt;&lt; p.width() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; p;</div>
<div class="line">        ASSERT_TRUE(p.is_prime());</div>
<div class="line">        ASSERT_EQ(p.width(), w);</div>
<div class="line"> </div>
<div class="line">        p -= 1;</div>
<div class="line">        p /= 2;</div>
<div class="line">        <span class="keywordflow">if</span> (p.is_prime())</div>
<div class="line">        {</div>
<div class="line">            cout &lt;&lt; <span class="stringliteral">&quot; SAFE&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        cout &lt;&lt; endl;</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt;= 128; i++)      gen(i);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, bit_test_set_clear)</div>
<div class="line">{</div>
<div class="line">    Bignum w32(3);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;init w32     n=&quot;</span>&lt;&lt;std::hex&lt;&lt;w32&lt;&lt;std::dec&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; w32.width()&lt;&lt;std::endl;</div>
<div class="line">    ASSERT_EQ(w32.width(), 2);</div>
<div class="line">    ASSERT_TRUE(w32.is_bit_set(0));</div>
<div class="line">    ASSERT_TRUE(w32.is_bit_set(1));</div>
<div class="line">    ASSERT_FALSE(w32.is_bit_set(2));</div>
<div class="line">    w32.set_bit(30);</div>
<div class="line">    w32.set_bit(31);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;set bit 30-31 n=&quot;</span>&lt;&lt;std::hex&lt;&lt;w32&lt;&lt;std::dec&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; w32.width()&lt;&lt;std::endl;</div>
<div class="line">    ASSERT_EQ(w32, 0xc0000003);</div>
<div class="line">    ASSERT_EQ(w32.width(), 32);</div>
<div class="line">    ASSERT_TRUE(w32.is_bit_set(0));</div>
<div class="line">    ASSERT_TRUE(w32.is_bit_set(1));</div>
<div class="line">    ASSERT_FALSE(w32.is_bit_set(2));</div>
<div class="line">    ASSERT_TRUE(w32.is_bit_set(30));</div>
<div class="line">    ASSERT_TRUE(w32.is_bit_set(31));</div>
<div class="line">    ASSERT_FALSE(w32.is_bit_set(32));</div>
<div class="line">    w32.clear_bit(30);</div>
<div class="line">    w32.clear_bit(31);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;clr w32 30-31 n=&quot;</span>&lt;&lt;std::hex&lt;&lt;w32&lt;&lt;std::dec&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; w32.width()&lt;&lt;std::endl;</div>
<div class="line">    ASSERT_EQ(w32, 0x3);</div>
<div class="line">    ASSERT_EQ(w32.width(), 2);</div>
<div class="line">    ASSERT_TRUE(w32.is_bit_set(0));</div>
<div class="line">    ASSERT_TRUE(w32.is_bit_set(1));</div>
<div class="line">    ASSERT_FALSE(w32.is_bit_set(2));</div>
<div class="line">    ASSERT_FALSE(w32.is_bit_set(30));</div>
<div class="line">    ASSERT_FALSE(w32.is_bit_set(31));</div>
<div class="line">    ASSERT_FALSE(w32.is_bit_set(32));</div>
<div class="line"> </div>
<div class="line">    Bignum w64(3);</div>
<div class="line">    w64 &lt;&lt;= 32;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;init w64     n=&quot;</span>&lt;&lt;std::hex&lt;&lt;w64&lt;&lt;std::dec&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; w64.width()&lt;&lt;std::endl;</div>
<div class="line">    ASSERT_EQ(w64.width(), 34);</div>
<div class="line">    ASSERT_TRUE(w64.is_bit_set(32));</div>
<div class="line">    ASSERT_TRUE(w64.is_bit_set(33));</div>
<div class="line">    ASSERT_FALSE(w64.is_bit_set(34));</div>
<div class="line">    w64.set_bit(62);</div>
<div class="line">    w64.set_bit(63);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;set bit 62-63 n=&quot;</span>&lt;&lt;std::hex&lt;&lt;w64&lt;&lt;std::dec&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; w64.width()&lt;&lt;std::endl;</div>
<div class="line">    ASSERT_EQ(w64.width(), 64);</div>
<div class="line">    ASSERT_TRUE(w64.is_bit_set(32));</div>
<div class="line">    ASSERT_TRUE(w64.is_bit_set(33));</div>
<div class="line">    ASSERT_FALSE(w64.is_bit_set(34));</div>
<div class="line">    ASSERT_TRUE(w64.is_bit_set(62));</div>
<div class="line">    ASSERT_TRUE(w64.is_bit_set(63));</div>
<div class="line">    ASSERT_FALSE(w64.is_bit_set(64));</div>
<div class="line">    w64.clear_bit(62);</div>
<div class="line">    w64.clear_bit(63);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;clr bit 62-63 n=&quot;</span>&lt;&lt;std::hex&lt;&lt;w64&lt;&lt;std::dec&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; w64.width()&lt;&lt;std::endl;</div>
<div class="line">    ASSERT_EQ(w64.width(), 34);</div>
<div class="line">    ASSERT_TRUE(w64.is_bit_set(32));</div>
<div class="line">    ASSERT_TRUE(w64.is_bit_set(33));</div>
<div class="line">    ASSERT_FALSE(w64.is_bit_set(34));</div>
<div class="line">    ASSERT_FALSE(w64.is_bit_set(62));</div>
<div class="line">    ASSERT_FALSE(w64.is_bit_set(63));</div>
<div class="line">    ASSERT_FALSE(w64.is_bit_set(64));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, bit_ops_and)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> doit = [](<span class="keywordtype">int</span> wa, <span class="keywordtype">int</span> wb){</div>
<div class="line">        Bignum a(1);</div>
<div class="line">        a &lt;&lt;= wa-1;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;bit ops   a=&quot;</span>&lt;&lt;a.str(<span class="keyword">true</span>)&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; a.width()&lt;&lt;std::endl;</div>
<div class="line">        Bignum b(1);</div>
<div class="line">        b &lt;&lt;= wb-1;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;bit ops   b=&quot;</span>&lt;&lt;b.str(<span class="keyword">true</span>)&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; b.width()&lt;&lt;std::endl;</div>
<div class="line">        Bignum c;</div>
<div class="line">        c = a + b;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;bit ops   c=&quot;</span>&lt;&lt;c.str(<span class="keyword">true</span>)&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; c.width()&lt;&lt;std::endl;</div>
<div class="line">        Bignum x;</div>
<div class="line">        x = a &amp; b;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;bit ops a&amp;b=&quot;</span>&lt;&lt;x.str(<span class="keyword">true</span>)&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; x.width()&lt;&lt;std::endl;</div>
<div class="line">        ASSERT_EQ(x, 0);</div>
<div class="line">        x = a &amp; c;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;bit ops a&amp;c=&quot;</span>&lt;&lt;x.str(<span class="keyword">true</span>)&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; x.width()&lt;&lt;std::endl;</div>
<div class="line">        ASSERT_EQ(x, a);</div>
<div class="line">        x = b &amp; c;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;bit ops b&amp;c=&quot;</span>&lt;&lt;x.str(<span class="keyword">true</span>)&lt;&lt;<span class="stringliteral">&quot; width: &quot;</span>&lt;&lt; x.width()&lt;&lt;std::endl;</div>
<div class="line">        ASSERT_EQ(x, b);</div>
<div class="line">        x = c;</div>
<div class="line">        x &amp;= a;</div>
<div class="line">        ASSERT_EQ(x, a);</div>
<div class="line">        x = c;</div>
<div class="line">        x &amp;= b;</div>
<div class="line">        ASSERT_EQ(x, b);</div>
<div class="line">    };</div>
<div class="line">    doit(1, 2);</div>
<div class="line">    doit(30, 31);</div>
<div class="line">    doit(31, 32);</div>
<div class="line">    doit(32, 33);</div>
<div class="line"> </div>
<div class="line">    Bignum a(1), b(2);</div>
<div class="line">    ASSERT_EQ(a&amp;3, 1);</div>
<div class="line">    ASSERT_EQ(b&amp;3, 2);</div>
<div class="line">    Bignum x = a&amp;3;</div>
<div class="line">    ASSERT_EQ(x, 1);</div>
<div class="line">    x = b&amp;3;</div>
<div class="line">    ASSERT_EQ(x, 2);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, bit_ops_or)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> doit = [](<span class="keywordtype">int</span> wa, <span class="keywordtype">int</span> wb){</div>
<div class="line">        Bignum a(1);</div>
<div class="line">        a &lt;&lt;= wa-1;</div>
<div class="line">        Bignum b(1);</div>
<div class="line">        b &lt;&lt;= wb-1;</div>
<div class="line">        Bignum c;</div>
<div class="line">        c = a + b;</div>
<div class="line">        Bignum x;</div>
<div class="line">        x = a | b;</div>
<div class="line">        ASSERT_EQ(x, c);</div>
<div class="line">        x = a | c;</div>
<div class="line">        ASSERT_EQ(x, c);</div>
<div class="line">        x = b | c;</div>
<div class="line">        ASSERT_EQ(x, c);</div>
<div class="line">        x = c;</div>
<div class="line">        x |= a;</div>
<div class="line">        ASSERT_EQ(x, c);</div>
<div class="line">        x = c;</div>
<div class="line">        x |= b;</div>
<div class="line">        ASSERT_EQ(x, c);</div>
<div class="line">    };</div>
<div class="line">    doit(1, 2);</div>
<div class="line">    doit(30, 31);</div>
<div class="line">    doit(31, 32);</div>
<div class="line">    doit(32, 33);</div>
<div class="line"> </div>
<div class="line">    Bignum a(1), b(2);</div>
<div class="line">    ASSERT_EQ(a|3, 3);</div>
<div class="line">    ASSERT_EQ(b|3, 3);</div>
<div class="line">    Bignum x = a|3;</div>
<div class="line">    ASSERT_EQ(x, 3);</div>
<div class="line">    x = b|3;</div>
<div class="line">    ASSERT_EQ(x, 3);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, bit_ops_xor)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> doit = [](<span class="keywordtype">int</span> wa, <span class="keywordtype">int</span> wb){</div>
<div class="line">        Bignum a(1);</div>
<div class="line">        a &lt;&lt;= wa-1;</div>
<div class="line">        Bignum b(1);</div>
<div class="line">        b &lt;&lt;= wb-1;</div>
<div class="line">        Bignum c;</div>
<div class="line">        c = a + b;</div>
<div class="line">        Bignum x;</div>
<div class="line">        x = a ^ b;</div>
<div class="line">        ASSERT_EQ(x, c);</div>
<div class="line">        x = a ^ c;</div>
<div class="line">        ASSERT_EQ(x, b);</div>
<div class="line">        x = b ^ c;</div>
<div class="line">        ASSERT_EQ(x, a);</div>
<div class="line">        x = c;</div>
<div class="line">        x ^= a;</div>
<div class="line">        ASSERT_EQ(x, b);</div>
<div class="line">        x = c;</div>
<div class="line">        x ^= b;</div>
<div class="line">        ASSERT_EQ(x, a);</div>
<div class="line">    };</div>
<div class="line">    doit(1, 2);</div>
<div class="line">    doit(30, 31);</div>
<div class="line">    doit(31, 32);</div>
<div class="line">    doit(32, 33);</div>
<div class="line"> </div>
<div class="line">    Bignum a(1), b(2), c(3);</div>
<div class="line">    ASSERT_EQ(c^1, 2);</div>
<div class="line">    ASSERT_EQ(c^2, 1);</div>
<div class="line">    Bignum x = c^1;</div>
<div class="line">    ASSERT_EQ(x, 2);</div>
<div class="line">    x = c^2;</div>
<div class="line">    ASSERT_EQ(x, 1);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, bit_ops_not)</div>
<div class="line">{</div>
<div class="line">    Bignum a=1, b=0;</div>
<div class="line">    ASSERT_EQ(~a, b);</div>
<div class="line">    ASSERT_EQ(~b, a);</div>
<div class="line">    a=0xffff0000;</div>
<div class="line">    b=0xffff;</div>
<div class="line">    ASSERT_EQ(~a, b);</div>
<div class="line">    a &lt;&lt;= 16;</div>
<div class="line">    b=0xffffffff;</div>
<div class="line">    ASSERT_EQ(~a, b);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, width)</div>
<div class="line">{</div>
<div class="line">    Bignum a(0xf);</div>
<div class="line">    ASSERT_EQ(a.width(), 4);</div>
<div class="line">    <span class="keyword">auto</span> p = [](<span class="keywordtype">int</span> shift)</div>
<div class="line">    {</div>
<div class="line">        Bignum b = 1;</div>
<div class="line">        b &lt;&lt;= shift;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;width of &quot;</span> &lt;&lt; b.str(<span class="keyword">true</span>) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; b.width() &lt;&lt; endl;</div>
<div class="line">        ASSERT_EQ(b.width(), shift+1);</div>
<div class="line">    };</div>
<div class="line">    Bignum b = 0;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;width of &quot;</span> &lt;&lt; b.str(<span class="keyword">true</span>) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; b.width() &lt;&lt; endl;</div>
<div class="line">    ASSERT_EQ(b.width(), 1);</div>
<div class="line">    p(0);</div>
<div class="line">    p(1);</div>
<div class="line">    p(30);</div>
<div class="line">    p(31);</div>
<div class="line">    p(32);</div>
<div class="line">    p(33);</div>
<div class="line">    p(147);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, negative)</div>
<div class="line">{</div>
<div class="line">    Bignum a;</div>
<div class="line">    </div>
<div class="line">    ASSERT_FALSE(a.is_negative());</div>
<div class="line">    a = 128;</div>
<div class="line">    ASSERT_FALSE(a.is_negative());</div>
<div class="line">    a = -a;</div>
<div class="line">    ASSERT_TRUE(a.is_negative());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, get)</div>
<div class="line">{</div>
<div class="line">    Bignum a;</div>
<div class="line">    vector&lt;char&gt; v;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_test = [&amp;]</div>
<div class="line">    {</div>
<div class="line">        v.resize(a.len());</div>
<div class="line">        a.get((<span class="keywordtype">void</span>*)v.data(), v.size());</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; get hex &quot;</span> &lt;&lt; Hex::bin_to_hexstr(v, <span class="stringliteral">&quot; &quot;</span>) &lt;&lt; endl;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    get_test();</div>
<div class="line">    a = 127;</div>
<div class="line">    get_test();</div>
<div class="line">    ASSERT_EQ(v, vector&lt;char&gt;{<span class="stringliteral">&#39;\x7f&#39;</span>});</div>
<div class="line">    a = -a;</div>
<div class="line">    ASSERT_THROW(get_test(), runtime_error);</div>
<div class="line">    a = 128;</div>
<div class="line">    get_test();</div>
<div class="line">    ASSERT_EQ(v, vector&lt;char&gt;{<span class="stringliteral">&#39;\x80&#39;</span>});</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a>(bignum_test, get_2sc)</div>
<div class="line">{</div>
<div class="line">    Bignum a;</div>
<div class="line">    vector&lt;char&gt; v;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_test = [&amp;](vector&lt;char&gt; chk)</div>
<div class="line">    {</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; len_2sc() = &quot;</span> &lt;&lt; a.len_2sc() &lt;&lt; endl;</div>
<div class="line">        v.resize(a.len_2sc());</div>
<div class="line">        a.get_2sc((<span class="keywordtype">void</span>*)v.data(), v.size());</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot; get hex &quot;</span> &lt;&lt; Hex::bin_to_hexstr(v, <span class="stringliteral">&quot; &quot;</span>) &lt;&lt; endl;</div>
<div class="line">        ASSERT_EQ(v, chk);</div>
<div class="line">    };</div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">        128 0000 0000 1000 0000 - 00 80</span></div>
<div class="line"><span class="comment">        127 0111 1111 - 7f</span></div>
<div class="line"><span class="comment">        -1 1111 1111 - ff</span></div>
<div class="line"><span class="comment">        -127 1000 0001 - 81</span></div>
<div class="line"><span class="comment">        -128 1000 0000 - 80</span></div>
<div class="line"><span class="comment">        -129 1111 1111 0111 1111 - ff 7f</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line">    get_test({<span class="stringliteral">&#39;\x00&#39;</span>});</div>
<div class="line">    a = 128;</div>
<div class="line">    get_test({<span class="stringliteral">&#39;\x00&#39;</span>,<span class="stringliteral">&#39;\x80&#39;</span>});</div>
<div class="line">    a = 127;</div>
<div class="line">    get_test({<span class="stringliteral">&#39;\x7f&#39;</span>});</div>
<div class="line">    a = 1;</div>
<div class="line">    a = -a;</div>
<div class="line">    get_test({<span class="stringliteral">&#39;\xff&#39;</span>});</div>
<div class="line">    a = 127;</div>
<div class="line">    a = -a;</div>
<div class="line">    get_test({<span class="stringliteral">&#39;\x81&#39;</span>});</div>
<div class="line">    a = 128;</div>
<div class="line">    a = -a;</div>
<div class="line">    get_test({<span class="stringliteral">&#39;\x80&#39;</span>});</div>
<div class="line">    a = 129;</div>
<div class="line">    a = -a;</div>
<div class="line">    get_test({<span class="stringliteral">&#39;\xff&#39;</span>,<span class="stringliteral">&#39;\x7f&#39;</span>});</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="aclassscc_1_1encode_1_1Hex_html"><div class="ttname"><a href="../../d2/ddc/classscc_1_1encode_1_1Hex.html">scc::encode::Hex</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d84/hex_8h_source.html#l00053">hex.h:53</a></div></div>
<div class="ttc" id="aclassscc_1_1crypto_1_1Bignum_html_a5d000d47bfb2c00443acc33535d6aaf4"><div class="ttname"><a href="../../da/d2a/classscc_1_1crypto_1_1Bignum.html#a5d000d47bfb2c00443acc33535d6aaf4">scc::crypto::Bignum::gcd</a></div><div class="ttdeci">void gcd(const Bignum &amp;)</div><div class="ttdoc">Greatest common divisor for a and b.</div></div>
<div class="ttc" id="abignum_8h_html_abc9625a3e7b87afe6a826394a00f19b3"><div class="ttname"><a href="../../dd/da2/bignum_8h.html#abc9625a3e7b87afe6a826394a00f19b3">gcd</a></div><div class="ttdeci">scc::crypto::Bignum gcd(const scc::crypto::Bignum &amp;, const scc::crypto::Bignum &amp;)</div><div class="ttdoc">Greatest common divisor helper.</div></div>
<div class="ttc" id="ahex_8h_html"><div class="ttname"><a href="../../d0/d84/hex_8h.html">hex.h</a></div><div class="ttdoc">Binary to hex string converter.</div></div>
<div class="ttc" id="aunittest_2inet_8cc_html_a821ca81eacb859889b5efeae7ffa1997"><div class="ttname"><a href="../../dd/d8d/unittest_2inet_8cc.html#a821ca81eacb859889b5efeae7ffa1997">TEST</a></div><div class="ttdeci">TEST(inet_example, client_server_stream_test)</div><div class="ttdoc">[Inet client server]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/unittest_2inet_8cc_source.html#l00521">inet.cc:521</a></div></div>
<div class="ttc" id="abignum_8h_html"><div class="ttname"><a href="../../dd/da2/bignum_8h.html">bignum.h</a></div><div class="ttdoc">Big number arithmetic.</div></div>
<div class="ttc" id="abignum_8h_html_a404ea288a7ccbcdcf2de54410ce68847"><div class="ttname"><a href="../../dd/da2/bignum_8h.html#a404ea288a7ccbcdcf2de54410ce68847">exp</a></div><div class="ttdeci">scc::crypto::Bignum exp(const scc::crypto::Bignum &amp;, const scc::crypto::Bignum &amp;)</div><div class="ttdoc">Exponent helper.</div></div>
<div class="ttc" id="aclassscc_1_1crypto_1_1Bignum_html"><div class="ttname"><a href="../../da/d2a/classscc_1_1crypto_1_1Bignum.html">scc::crypto::Bignum</a></div><div class="ttdoc">Big number.</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da2/bignum_8h_source.html#l00058">bignum.h:58</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
